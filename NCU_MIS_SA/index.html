<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta content="width=device-width, initial-scale=1.0" name="viewport" />

    <title>首頁 ｜ 宿舍管理系統</title>
    <meta content="" name="description" />

    <meta content="" name="keywords" />

    <!-- Favicons -->
    <link href="statics/icon/favicon.ico" rel="icon" />
    <link href="statics/img/apple-touch-icon.png" rel="apple-touch-icon" />

    <!-- Google Fonts -->
    <link
      href="https://fonts.googleapis.com/css?family=Open+Sans:300,300i,400,400i,600,600i,700,700i|Nunito:300,300i,400,400i,600,600i,700,700i|Poppins:300,300i,400,400i,500,500i,600,600i,700,700i"
      rel="stylesheet"
    />

    <!-- Vendor CSS Files -->
    <link href="statics/vendor/aos/aos.css" rel="stylesheet" />
    <link
      href="statics/vendor/bootstrap/css/bootstrap.min.css"
      rel="stylesheet"
    />
    <link
      href="statics/vendor/bootstrap-icons/bootstrap-icons.css"
      rel="stylesheet"
    />
    <link
      href="statics/vendor/glightbox/css/glightbox.min.css"
      rel="stylesheet"
    />
    <link href="statics/vendor/remixicon/remixicon.css" rel="stylesheet" />
    <link href="statics/vendor/swiper/swiper-bundle.min.css" rel="stylesheet" />

    <link
      rel="stylesheet"
      href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
      integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p"
      crossorigin="anonymous"
    />
    <script src="statics/js/jquery-3.4.1.min.js"></script>
    <!-- Template Main CSS File -->
    <link href="statics/css/style.css" rel="stylesheet" />

    <!-- =======================================================
  * Template Name: FlexStart - v1.9.0
  * Template URL: https://bootstrapmade.com/flexstart-bootstrap-startup-template/
  * Author: BootstrapMade.com
  * License: https://bootstrapmade.com/license/
  ======================================================== -->
  </head>

  <script>
    var name;
    var role;
    function checkID() {
      $.ajax({
        type: "GET",
        url: "api/login.do",
        crossDomain: true,
        cache: false,
        dataType: "json",
        timeout: 5000,
        success: function (response) {
          if (response.status == 200) {
            if (response.response.status == "login") {
              //未登入
              name = response.response.name;
              role = response.response.role;
              if (role == "1" || role == "2") {
              } else {
                //notAdmin();
              }
            } else {
              //notLogin();
            }
            console.log(response);
          }
        },
        error: function () {
          alert("無法連線到伺服器！");
        },
      });
    }
    checkID();
    //alert(name);
    function notLogin() {
      alert("請先登入!");
      window.location = "login.html";
    }
    function notAdmin() {
      alert("你不是管理員!");
      window.location = "index.html";
    }
  </script>
  <body>
    <!-- ======= Header ======= -->
    <header id="header" class="header fixed-top">
      <div
        class="container-fluid container-xl d-flex align-items-center justify-content-between"
      >
        <a href="index.html" class="logo d-flex align-items-center">
          <img src="statics/img/logo.png" alt="" />
          <span>宿舍管理系統</span>
        </a>

        <nav id="navbar" class="navbar">
          <ul>
            <li><a class="nav-link scrollto active" href="index.html#hero">首頁</a></li>
            <li><a class="nav-link scrollto" href="index.html#services">選單</a></li>
            <li class="nav-item dropdown">
              <a
                class="nav-link dropdown-toggle"
                href="#"
                id="navbarDropdown"
                role="button"
                data-bs-toggle="dropdown"
                aria-expanded="false"
              >
                其他功能
              </a>

              <ul class="dropdown-menu" aria-labelledby="navbarDropdown">
                <li>
                  <a
                    class="nav-link dropdown-item scrollto"
                    href="index.html#bulletin_board"
                    >公告欄</a
                  >
                </li>
                <li>
                  <a
                    class="nav-link dropdown-item scrollto"
                    href="discussion_board.html"
                    >討論版</a
                  >
                </li>
                <li>
                  <a class="nav-link dropdown-item scrollto" href="payment.html"
                    >宿舍繳費</a
                  >
                </li>
                <li>
                  <a
                    class="nav-link dropdown-item scrollto"
                    href="dormManagement.html"
                    >宿舍報修</a
                  >
                </li>
                <li>
                  <a
                    class="nav-link dropdown-item scrollto"
                    href="check_in.html"
                    >報到手續</a
                  >
                </li>
                <li>
                  <a
                    class="nav-link dropdown-item scrollto"
                    href="check_out.html"
                    >退宿手續</a
                  >
                </li>
                <li>
                  <hr class="dropdown-divider admin" />
                </li>
                <li>
                  <a
                    class="nav-link dropdown-item scrollto admin"
                    href="member.html"
                    >會員管理</a
                  >
                </li>
                <li>
                  <a
                    class="nav-link dropdown-item scrollto admin"
                    href="bulletinboard.html"
                    >公告欄管理</a
                  >
                </li>
              </ul>
            </li>

            <div id="loginOrNot"></div>
          </ul>
          <i class="bi bi-list mobile-nav-toggle"></i>
        </nav>
        <!-- .navbar -->
      </div>
    </header>
    <!-- End Header -->

    <!-- ======= Hero Section ======= -->
    <section id="hero" class="hero d-flex align-items-center">
      <div class="container">
        <div class="row">
          <div class="col-lg-6 d-flex flex-column justify-content-center">
            <h1 data-aos="fade-up">宿舍小幫手</h1>
            <h2 data-aos="fade-up" data-aos-delay="400">
              解決宿舍生活疑難雜症
            </h2>
            <div data-aos="fade-up" data-aos-delay="600">
              <div class="text-center text-lg-start">
                <a
                  href="#services"
                  class="btn-get-started scrollto d-inline-flex align-items-center justify-content-center align-self-center"
                >
                  <span>開始使用</span>
                  <i class="bi bi-arrow-right"></i>
                </a>
              </div>
            </div>
          </div>
          <div
            class="col-lg-6 hero-img"
            data-aos="zoom-out"
            data-aos-delay="200"
          >
            <img src="statics/img/hero-img.png" class="img-fluid" alt="" />
          </div>
        </div>
      </div>
    </section>
    <!-- End Hero -->

    <!-- ======= Services Section ======= -->
    <section id="services" class="services">
      <div class="container" data-aos="fade-up">
        <header class="section-header">
          <h2>八大服務</h2>
          <p>以下共有八大不同種類服務以滿足各種需求</p>
        </header>

        <div class="row gy-3">
          <div
            class="col-lg-3 col-md-8"
            data-aos="fade-up"
            data-aos-delay="200"
          >
            <div class="service-box purple">
              <i class="ri-discuss-line icon"></i>
              <h3>公告欄</h3>
              <p>宿舍公告欄<br />公告宿舍相關事務</p>
              <a href="#bulletin_board" class="read-more"
                ><span>查看更多</span> <i class="bi bi-arrow-right"></i
              ></a>
            </div>
          </div>

          <div
            class="col-lg-3 col-md-8"
            data-aos="fade-up"
            data-aos-delay="200"
          >
            <div class="service-box red">
              <i class="ri-discuss-line icon"></i>
              <h3>討論板</h3>
              <p><br />宿民討論版<br />宿舍大小事分享</p>
              <a href="discussion_board.html" class="read-more"
                ><span>查看更多</span> <i class="bi bi-arrow-right"></i
              ></a>
            </div>
          </div>

          <div
            class="col-lg-3 col-md-8"
            data-aos="fade-up"
            data-aos-delay="300"
          >
            <div class="service-box orange">
              <i class="ri-discuss-line icon"></i>
              <h3>宿舍繳費</h3>
              <p>宿舍繳費系統<br />在此能找到各種繳費相關資訊</p>
              <a href="payment.html" class="read-more"
                ><span>查看更多</span> <i class="bi bi-arrow-right"></i
              ></a>
            </div>
          </div>

          <div
            class="col-lg-3 col-md-8"
            data-aos="fade-up"
            data-aos-delay="400"
          >
            <div class="service-box green">
              <i class="ri-discuss-line icon"></i>
              <h3>宿舍報修</h3>
              <p>宿舍報修<br />在此報修各種損毀的設備</p>
              <a href="dormManagement.html" class="read-more"
                ><span>查看更多</span> <i class="bi bi-arrow-right"></i
              ></a>
            </div>
          </div>

          <div
            class="col-lg-3 col-md-8"
            data-aos="fade-up"
            data-aos-delay="500"
          >
            <div class="service-box red">
              <i class="ri-discuss-line icon"></i>
              <h3>報到手續</h3>
              <p>新宿民報到<br />入宿前在此線上報到</p>
              <a href="check_in.html" class="read-more"
                ><span>查看更多</span> <i class="bi bi-arrow-right"></i
              ></a>
            </div>
          </div>

          <div
            class="col-lg-3 col-md-8"
            data-aos="fade-up"
            data-aos-delay="600"
          >
            <div class="service-box purple">
              <i class="ri-discuss-line icon"></i>
              <h3>退宿手續</h3>
              <p>退宿<br />在此提供線上退宿檢查</p>
              <a href="check_out.html" class="read-more"
                ><span>查看更多</span> <i class="bi bi-arrow-right"></i
              ></a>
            </div>
          </div>

          <div
            class="col-lg-3 col-md-8 admin"
            data-aos="fade-up"
            data-aos-delay="200"
          >
            <div class="service-box blue">
              <i class="ri-discuss-line icon"></i>
              <h3>會員管理</h3>
              <p>個資管理<br />編輯個人資訊</p>
              <a href="member.html" class="read-more"
                ><span>查看更多</span> <i class="bi bi-arrow-right"></i
              ></a>
            </div>
          </div>

          <div
            class="col-lg-3 col-md-8 admin"
            data-aos="fade-up"
            data-aos-delay="700"
          >
            <div class="service-box pink">
              <i class="ri-discuss-line icon"></i>
              <h3>公告欄管理</h3>
              <p>管理公告欄項目<br />新增 / 刪除 / 修改公告</p>
              <a href="admin.html" class="read-more"
                ><span>查看更多</span> <i class="bi bi-arrow-right"></i
              ></a>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- End Services Section -->

    <section id="bulletin_board" class="blog">
      <div class="container" data-aos="fade-up">
        <header class="section-header">
          <h2>公告欄</h2>
          <p>以下為近期各種消息</p>
        </header>

        <div class="row align-items-center">
          <div class="col-lg-12 entries" id="board">
            <article class="entry">
              <div class="entry-img">
              </div>

              <h2 class="entry-title">
                <a 
                  >公告標題: title</a
                >
              </h2>

              <div class="entry-meta">
                <ul>
                  <li class="d-flex align-items-center">
                    <i class="bi bi-clock"></i>
                    <a href="blog-single.html"
                      ><time datetime="2020-01-01">建立日期: Jan 1, 2020</time></a
                    >
                  </li>
                </ul>
              </div>

              <div class="entry-content">
                <p>內文:<br>
                content
                </p>
              </div>
            </article>
            
          </div>
            <!-- End blog entry -->
            <!-- <article class="entry">
              <div class="entry-img">
                <img
                  src="statics/img/blog/blog-1.jpg"
                  alt=""
                  class="img-fluid"
                />
              </div>

              <h2 class="entry-title">
                <a href="blog-single.html"
                  >Dolorum optio tempore voluptas dignissimos cumque fuga qui
                  quibusdam quia</a
                >
              </h2>

              <div class="entry-meta">
                <ul>
                  <li class="d-flex align-items-center">
                    <i class="bi bi-person"></i>
                    <a href="blog-single.html">John Doe</a>
                  </li>
                  <li class="d-flex align-items-center">
                    <i class="bi bi-clock"></i>
                    <a href="blog-single.html"
                      ><time datetime="2020-01-01">Jan 1, 2020</time></a
                    >
                  </li>
                  <li class="d-flex align-items-center">
                    <i class="bi bi-chat-dots"></i>
                    <a href="blog-single.html">12 Comments</a>
                  </li>
                </ul>
              </div>

              <div class="entry-content">
                <p>
                  Similique neque nam consequuntur ad non maxime aliquam quas.
                  Quibusdam animi praesentium. Aliquam et laboriosam eius aut
                  nostrum quidem aliquid dicta. Et eveniet enim. Qui velit est
                  ea dolorem doloremque deleniti aperiam unde soluta. Est cum et
                  quod quos aut ut et sit sunt. Voluptate porro consequatur
                  assumenda perferendis dolore.
                </p>
                <div class="read-more">
                  <a href="blog-single.html">Read More</a>
                </div>
              </div>
            </article> -->
          <!-- End blog entries list -->
        </div>
      </div>
    </section>
    <!-- End Blog Section -->
    <footer id="footer" class="footer">
      <div class="footer-top">
        <div class="container">
          <div class="copyright">
            &copy; Copyright <strong><span>FlexStart</span></strong
            >. All Rights Reserved <br />
            <span class="text-align-center">系統分析與設計_期末專案</span>
            <span class="text-align-center">第17組</span>
          </div>

          <div class="credits">
            <!-- All the links in the footer should remain intact. -->
            <!-- You can delete the links only if you purchased the pro version. -->
            <!-- Licensing information: https://bootstrapmade.com/license/ -->
            <!-- Purchase the pro version with working PHP/AJAX contact form: https://bootstrapmade.com/flexstart-bootstrap-startup-template/ -->
            Designed by <a href="https://bootstrapmade.com/">BootstrapMade</a>
          </div>
        </div>
      </div>
    </footer>
    <!-- End Footer -->

    <a
      href="#"
      class="back-to-top d-flex align-items-center justify-content-center"
      ><i class="bi bi-arrow-up-short"></i
    ></a>

    <!-- Vendor JS Files -->
    <script src="statics/vendor/purecounter/purecounter.js"></script>
    <script src="statics/vendor/aos/aos.js"></script>
    <script src="statics/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <script src="statics/vendor/glightbox/js/glightbox.min.js"></script>
    <script src="statics/vendor/isotope-layout/isotope.pkgd.min.js"></script>
    <script src="statics/vendor/swiper/swiper-bundle.min.js"></script>
    <script src="statics/vendor/php-email-form/validate.js"></script>

    <!-- Template Main JS File -->
    <script src="statics/js/main.js"></script>
    <script>
    $(document).ready(function(){
        $(".admin").hide();
        if (role == 1 || role == 2) {
          $(".admin").show();
        }
    });
      //account function
      function checkLogin() {
        $.ajax({
          type: "GET",
          url: "api/login.do",
          crossDomain: true,
          cache: false,
          dataType: "json",
          timeout: 5000,
          success: function (response) {
            if (response.status == 200) {
              let inner_html = "";
              if (response.response.status != "login") {
                //未登入
                inner_html +=
                  '<li class="nav-item"><a class="getstarted scrollto" href="login.html" role="button">登入 / 註冊</a></li>';
              } else {
                //登入
                inner_html +=
                  '<li class="dropdown"><a href="#"><span>' +
                  response.response.name +
                  '</span> <i class="bi bi-chevron-down"></i></a><ul><li><a href="self-info.html">使用者資訊</a></li><li><a id="logout" onclick="Logout()" role="button">登出</a></li></ul></li>';
              }
              $("#loginOrNot").append(inner_html);
            }
            console.log(response);
          },
          error: function () {
            alert("無法連線到伺服器！");
          },
        });
      }
      checkLogin();

      function Logout() {
        // 發出POST的AJAX請求
        $.ajax({
          type: "POST",
          url: "api/logout.do",
          crossDomain: true,
          cache: false,
          dataType: "json",
          timeout: 5000,
          success: function (response) {
            if (response.status == 200) {
            }
            console.log(response);
          },
          error: function () {
            alert("無法連線到伺服器！");
          },
        });
        window.location.reload();
      }
      //end account function
      function getBoard(){
          $.ajax({
            type: "GET",
            url: "api/BulletinBoard.do",
            crossDomain: true,
            cache: false,
            dataType: 'json',
            timeout: 5000,
            success: function (response) {
              if (response.status == 200) {
            	  var board='';
            	  
            		console.log(response.response.data);
            	  	$.each(response.response.data, function (){
            			board += addBoard(this);
            		})
            		$('#board').append(board);
              }
            },
            error: function () {
              alert("無法連線到伺服器！");
            }
          });
      }
      function addBoard(data) {
      	document.getElementById('board').innerHTML="";
      	let inner_html = '';
      	inner_html+='<article class="entry"><div class="entry-img"></div><h2 class="entry-title"><a>公告標題: '+data.topic+'</a></h2>';
		inner_html+='<div class="entry-meta"><ul><li class="d-flex align-items-center"><i class="bi bi-clock"></i><a><time datetime="2020-01-01">建立日期: '+data.modified.split(" ",1)+'</time></a></li></ul></div> <div class="entry-content"><p>內文:<br>'+data.content+'</p></div></article>';
  		return inner_html;
      }
      getBoard();
    </script>
  </body>
</html>
